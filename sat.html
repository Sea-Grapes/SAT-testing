<!DOCTYPE html>
<title>SAT Testing</title>
<script src="https://cdn.tailwindcss.com"></script>

<main class='max-w-8xl mx-auto p-8'>
  <h1 class='text-2xl font-semibold mb-4'>SAT Testing Lookup</h1>
  <div class='inline-block border border-slate-300 rounded-lg overflow-hidden'>
    <table>
      <tbody class='divide-y divide-slate-300 *:divide-x *:divide-slate-300'>
        <tr class='bg-slate-100 font-medium text-slate-400 text-left *:py-4 *:px-6'>
          <th>Date</th>
          <th>School</th>
          <th>Address</th>
          <th>Distance</th>
        </tr>
        <tr>
        </tr>
        <tr class='*:py-4 *:px-6'>
          <td>August 24, 2024 â€” Saturday</td>
          <td>Rainier Beach High School</td>
          <td>8815 Seward Park Avenue South Seattle, WA 98118</td>
          <td>11.65 mi</td>
        </tr>
      </tbody>
    </table>
  </div>
</main>

<script>

const log = msg => console.log(`[SAT] ${msg}`)

function updateData() {
  localStorage.setItem('time', currentTime)
}

const currentTime = Date.now()
log(`Systems online ${currentTime}ms`)

const previousTime = localStorage.getItem('time') ?? 0
log(`Last updated ${previousTime}ms`)

const delayMS = currentTime - previousTime
const delayH = delayMS / (1000 * 60 * 60)
log(`It has been ${delayH.toFixed(3)}h since last fetched`)

if(delayH > 12) {
  log(`It has been more than 12h, time to update`)
  updateData()
}

else {
  log(`It has been less than 12h, no need to update`)
}

// fetch(`https://sat-admin-dates.collegeboard.org/`).then(res => res.json()).then(days => {
//   days = days.map(e => e.eventFormattedDate)
//   window.days = days
//   console.log(days)

//   days.forEach(day => fetch(`https://aru-test-center-search.collegeboard.org/prod/test-centers?date=${day}&zip=98075&country=US`))
// })
// .catch(e => alert('Error with CollegeBoard API'))
</script>